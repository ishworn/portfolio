;/*FB_PKG_DELIM*/

__d("EBLSMessagePointQuery",["I64","LSEncryptedBackupsBackupTenancy","LSFactory","LSIntEnum","LSIssuePointQueryRestoreTaskStoredProcedure","LSMEBTaskCreationSource","MAWEBRestoreTrackingUtils","MAWEncryptedBackupUtils","MWEncryptedBackUpEBNotEnabledError","QPLUserFlow","WAGetStorageQplAnnotations","WAHashStringToNumber","WAPushSafeTypes","WAResultOrError","asyncToGeneratorRuntime","cr:10036","err","promiseDone","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(b("cr:10036")==null)throw c("err")("Calling EBLS without EBLS being available for message range query");a=d("WAPushSafeTypes").unsafeNotNullable(a);var e=a.chatJid,f=a.messageId,g=a.startSortKey,j=a.taskSource,k=a.threadId;yield b("cr:10036").init();a=(yield b("cr:10036").getLSStorage());var l=(yield d("MAWEncryptedBackupUtils").getBackupTenancy(a.tables));if(l!=null&&!(h||(h=d("I64"))).equal(l,(i||(i=d("LSIntEnum"))).ofNumber(c("LSEncryptedBackupsBackupTenancy").PRODUCTION)))return d("WAResultOrError").makeError(d("MWEncryptedBackUpEBNotEnabledError").EB_NOT_ENABLED);l=d("WAHashStringToNumber").hashStringToNumber(f);var m=l.toString(),n=j===c("LSMEBTaskCreationSource").EB_POINT_QUERY_RETRY_DECRYPTION_FAILURES?c("LSMEBTaskCreationSource").EB_POINT_QUERY_RETRY_DECRYPTION_FAILURES:c("LSMEBTaskCreationSource").EB_POINT_QUERY_IN_ACT;n===c("LSMEBTaskCreationSource").EB_POINT_QUERY_RETRY_DECRYPTION_FAILURES&&(c("QPLUserFlow").start(c("qpl")._(1056840931,"814"),{instanceKey:l}),c("promiseDone")(d("WAGetStorageQplAnnotations").getStorageQplAnnotations().then(function(a){c("QPLUserFlow").addAnnotations(c("qpl")._(1056840931,"814"),a)})),c("QPLUserFlow").addPoint(c("qpl")._(1056840931,"814"),"eb_point_restore_begin",{data:{"int":{msgId:l},string:{jid:e}},instanceKey:l}));d("MAWEBRestoreTrackingUtils").markEBRestorePoint(n,m);return a.runInTransaction(function(a){return c("LSIssuePointQueryRestoreTaskStoredProcedure")(c("LSFactory")(a),{messageId:f,source:(i||(i=d("LSIntEnum"))).ofNumber(n),startSortKey:g,threadId:k,traceId:m})},"readwrite").then(function(){return d("WAResultOrError").makeResult()})});return j.apply(this,arguments)}g.messagePointQuery=a}),98);
__d("MAWMessageIntegrityLoggingSampleRate",["QuickPerformanceLogger","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=new Set([c("qpl")._(25303796,"1974")]);function a(){for(var a=i,b=Array.isArray(a),d=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(b){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;(h||(h=c("QuickPerformanceLogger"))).setAlwaysOnSampleRate(e,1)}}function b(){return 1}g.overwriteSamplingRate=a;g.getIntegrityCheckSampleRate=b}),98);